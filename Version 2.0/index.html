<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Dungeon Explorer</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="stylesheet" href="css/styles.css">
</head>
<body class="min-h-screen flex items-center justify-center p-4">

<!-- Login/Signup Screen -->
<div id="authScreen" class="max-w-md w-full pixel-border bg-gray-900 p-8">
    <h1 class="text-2xl text-center mb-8 text-yellow-400">üè∞ Dungeon Explorer</h1>
    
    <div id="loginForm">
        <h2 class="text-lg mb-4 text-center">Login</h2>
        <input type="text" id="loginUsername" placeholder="Username" class="w-full mb-4">
        <input type="password" id="loginPassword" placeholder="Password" class="w-full mb-4">
        <button onclick="login()" class="button-pixel w-full mb-2">Login</button>
        <button onclick="showSignup()" class="button-pixel w-full bg-green-600 border-green-700">Sign Up</button>
    </div>

    <div id="signupForm" style="display:none;">
        <h2 class="text-lg mb-4 text-center">Sign Up</h2>
        <input type="text" id="signupUsername" placeholder="Username" class="w-full mb-4">
        <input type="password" id="signupPassword" placeholder="Password" class="w-full mb-4">
        <input type="password" id="signupPasswordConfirm" placeholder="Confirm Password" class="w-full mb-4">
        <button onclick="signup()" class="button-pixel w-full mb-2">Create Account</button>
        <button onclick="showLogin()" class="button-pixel w-full bg-gray-600 border-gray-700">Back to Login</button>
    </div>
    
    <div id="authMessage" class="text-red-400 text-xs mt-4 text-center"></div>
</div>

<!-- Character Selection Screen -->
<div id="characterScreen" style="display:none;" class="max-w-2xl w-full pixel-border bg-gray-900 p-8">
    <h1 class="text-2xl text-center mb-8 text-yellow-400">Choose Your Character</h1>
    
    <div class="grid grid-cols-2 gap-8">
        <div class="character-option" onclick="selectCharacter('male')" id="maleChar">
            <div class="text-6xl text-center mb-4">üßô‚Äç‚ôÇÔ∏è</div>
            <h3 class="text-center text-sm">Male Adventurer</h3>
        </div>
        <div class="character-option" onclick="selectCharacter('female')" id="femaleChar">
            <div class="text-6xl text-center mb-4">üßô‚Äç‚ôÄÔ∏è</div>
            <h3 class="text-center text-sm">Female Adventurer</h3>
        </div>
    </div>
    
    <button onclick="startGame()" class="button-pixel w-full mt-8" id="startGameBtn" disabled>Start Adventure</button>
</div>

<!-- Main Game Screen -->
<div id="gameScreen" style="display:none;" class="max-w-6xl w-full">
    <!-- Stats Bar -->
    <div class="stats-bar flex justify-between items-center flex-wrap gap-4">
        <div>
            <span class="text-xs">Player: </span>
            <span id="playerName" class="text-yellow-400"></span>
        </div>
        <div>
            <span class="text-xs">Level: </span>
            <span id="currentLevel" class="text-green-400">1</span>
        </div>
        <div>
            <span class="text-xs">Hearts: </span>
            <span id="hearts"></span>
        </div>
        <div>
            <span class="text-xs">XP: </span>
            <span id="xpDisplay" class="text-blue-400">0</span>
        </div>
        <div>
            <span class="text-xs">Player Lvl: </span>
            <span id="playerLevel" class="text-purple-400">1</span>
        </div>
        <div class="flex gap-2">
            <button onclick="showLeaderboard()" class="button-pixel text-xs bg-purple-600 border-purple-700">Leaderboard</button>
            <button onclick="logout()" class="button-pixel text-xs bg-red-600 border-red-700">Logout</button>
        </div>
    </div>

    <!-- XP Progress Bar -->
    <div class="progress-bar mt-4">
        <div id="xpBar" class="progress-fill" style="width: 0%"></div>
    </div>
    <div class="text-xs text-center mt-1">XP to Next Level: <span id="xpToNext">100</span></div>

    <!-- Dungeon Grid -->
    <div class="flex justify-center mt-8">
        <div id="dungeonGrid" class="dungeon-grid"></div>
    </div>

    <div class="text-center mt-4 text-xs text-gray-400">
        Use WASD or Arrow Keys to move
    </div>
</div>

<!-- Puzzle Modal -->
<div id="puzzleModal" class="modal">
    <div class="modal-content">
        <h2 class="text-xl mb-6 text-yellow-400">Chest Puzzle!</h2>
        <div id="puzzleQuestion" class="text-sm mb-6"></div>
        <input type="text" id="puzzleAnswer" placeholder="Your Answer" class="w-full mb-6">
        <div class="flex gap-4">
            <button onclick="submitPuzzle()" class="button-pixel flex-1">Submit</button>
            <button onclick="closePuzzle()" class="button-pixel flex-1 bg-red-600 border-red-700">Cancel</button>
        </div>
    </div>
</div>

<!-- Leaderboard Modal -->
<div id="leaderboardModal" class="modal">
    <div class="modal-content" style="max-width: 800px;">
        <h2 class="text-xl mb-6 text-yellow-400">üèÜ Leaderboard</h2>
        
        <div class="mb-6">
            <h3 class="text-sm mb-2 text-green-400">Highest Level Reached</h3>
            <table class="leaderboard-table">
                <thead>
                    <tr>
                        <th>Rank</th>
                        <th>Player</th>
                        <th>Level</th>
                        <th>XP</th>
                    </tr>
                </thead>
                <tbody id="levelLeaderboard"></tbody>
            </table>
        </div>

        <div class="mb-6">
            <h3 class="text-sm mb-2 text-blue-400">Top Players by XP</h3>
            <table class="leaderboard-table">
                <thead>
                    <tr>
                        <th>Rank</th>
                        <th>Player</th>
                        <th>Player Level</th>
                        <th>Total XP</th>
                    </tr>
                </thead>
                <tbody id="xpLeaderboard"></tbody>
            </table>
        </div>

        <button onclick="closeLeaderboard()" class="button-pixel w-full">Close</button>
    </div>
</div>

<!-- Game Over Modal -->
<div id="gameOverModal" class="modal">
    <div class="modal-content">
        <h2 class="text-2xl mb-6 text-red-400">üíÄ Game Over!</h2>
        <p class="text-sm mb-4">You ran out of hearts!</p>
        <p class="text-xs mb-6">Final Level: <span id="finalLevel" class="text-yellow-400"></span></p>
        <button onclick="restartGame()" class="button-pixel w-full">Restart Game</button>
    </div>
</div>

<!-- Victory Modal -->
<div id="victoryModal" class="modal">
    <div class="modal-content">
        <h2 class="text-2xl mb-6 text-green-400">üéâ Chest Opened!</h2>
        <p class="text-sm mb-4">Correct! +50 XP</p>
        <button onclick="closeVictory()" class="button-pixel w-full">Continue</button>
    </div>
</div>

<!-- Death Modal -->
<div id="deathModal" class="modal">
    <div class="modal-content">
        <h2 class="text-xl mb-6 text-red-400">üíÄ You were eaten by the chest!</h2>
        <p class="text-sm mb-4">Wrong answer! -1 Heart</p>
        <p class="text-xs mb-6">Correct answer was: <span id="correctAnswer" class="text-yellow-400"></span></p>
        <button onclick="closeDeath()" class="button-pixel w-full">Continue</button>
    </div>
</div>

<script src="js/game.js"></script>
</body>
</html>